<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Syncing tasksâ€¦</title>
  <meta name="robots" content="noindex" />
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 24px; line-height: 1.4; }
    .card { max-width: 640px; margin: 10vh auto; border: 1px solid #ddd; border-radius: 12px; padding: 16px; }
    .muted { color: #666; font-size: 14px; }
    code { background: #f5f5f5; padding: 2px 4px; border-radius: 4px; }
    a { color: #0b74de; text-decoration: none; }
  </style>
  <script>
    (function(){
      const BASE_PATH = '/simple_task/';
      const BASE_URL = 'https://danielmartinscabanas.github.io' + BASE_PATH;
      const fromBase64Url = (b64url) => {
        let b64 = (b64url || '').replace(/-/g, '+').replace(/_/g, '/');
        while (b64.length % 4) b64 += '=';
        const binary = atob(b64);
        const bytes = new Uint8Array(binary.length);
        for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);
        const json = new TextDecoder().decode(bytes);
        return JSON.parse(json);
      };
      try {
        const p = location.pathname || '';
        const idx = p.indexOf(BASE_PATH);
        const rest = idx === -1 ? '' : p.slice(idx + BASE_PATH.length).replace(/^\/+/, '');
        if (rest) {
          const tasks = fromBase64Url(rest);
          if (!tasks || typeof tasks !== 'object') throw new Error('Invalid data');
          localStorage.setItem('tasks', JSON.stringify(tasks));
          location.replace(BASE_URL);
          return;
        }
      } catch (e) {
        console.error('URL import failed on 404:', e);
      }
    })();
  </script>
</head>
<body>
  <div class="card">
    <h3>Could not process shared URL</h3>
    <p class="muted">The link may be malformed. Go back to <a href="/simple_task/">SimpleTask</a> and try again.</p>
  </div>
</body>
</html>

